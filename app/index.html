<!--
 ______   __  __   ____     ____     __   __       __       __                 ___      
/\__  _\ /\ \/\ \ /\  _`\  /\  _`\  /\ \ /\ \     /\ \     /\ \__             /\_ \     
\/_/\ \/ \ \ `\\ \\ \ \/\ \\ \ \L\_\\ `\`\/'/'    \ \ \___ \ \ ,_\    ___ ___ \//\ \    
   \ \ \  \ \ , ` \\ \ \ \ \\ \  _\L `\/ > <       \ \  _ `\\ \ \/  /' __` __`\ \ \ \   
	\_\ \__\ \ \`\ \\ \ \_\ \\ \ \L\ \  \/'/\`\   __\ \ \ \ \\ \ \_ /\ \/\ \/\ \ \_\ \_ 
	/\_____\\ \_\ \_\\ \____/ \ \____/  /\_\\ \_\/\_\\ \_\ \_\\ \__\\ \_\ \_\ \_\/\____\
	\/_____/ \/_/\/_/ \/___/   \/___/   \/_/ \/_/\/_/ \/_/\/_/ \/__/ \/_/\/_/\/_/\/____/

-->                                                                                        

<!doctype html>
<html class="no-js">
	<head>
		<meta charset="utf-8">
		<title>timeline creation tool</title>
		<meta name="description" content="">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<link rel="shortcut icon" href="/favicon.ico">
		<!-- Place favicon.ico and apple-touch-icon.png in the root directory -->
		<!-- build:css(.) styles/vendor.css -->
		<!-- bower:css -->
		<!-- endbower -->
		<!-- endbuild -->
		<!-- build:css(.tmp) styles/main.css -->
		<link rel="stylesheet" href="styles/main.css">
		<!-- endbuild -->
		<!-- build:js scripts/vendor/modernizr.js -->
		<script src="bower_components/modernizr/modernizr.js"></script>
		<!-- endbuild -->
		<!-- <link href='http://fonts.googleapis.com/css?family=Muli' rel='stylesheet' type='text/css'> -->

	</head>
	<body>
		<!--[if lt IE 10]>
		<p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
		<![endif]-->

<!-- nav -->
			<nav class="navbar navbar-fixed-top navbar-inverse" role="navigation">
			  <div class="container-fluid">
				<!-- Brand and toggle get grouped for better mobile display -->
				<div class="navbar-header">
				  <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar-collapse">
					<span class="sr-only">Toggle navigation</span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
				  </button>
				  <a class="navbar-brand" href="#">TIMELINE CREATION TOOL</a>
				</div>

				<!-- Collect the nav links, forms, and other content for toggling -->
				<div class="collapse navbar-collapse" id="navbar-collapse">
				  <ul class="nav navbar-nav">
					<li class="scifi"><a href="#">SciFi</a></li>
					<li class="orbit"><a href="#">Orbit</a></li>
				  </ul>

				  <ul class="nav navbar-nav navbar-right">
					<li><a href="https://github.com/kevbost/timeline-creation-tool" target="_blank">View Source On Github</a></li>
				  </ul>
				</div><!-- /.navbar-collapse -->
			  </div><!-- /.container-fluid -->
			</nav>
<!-- /nav -->


<!-- main area -->

		<div class="container-full">
			<div class="jumbotron">

				<div class="form-group">
					<div class="row input-dates">
						<div class="col-xs-12 col-sm-6 col-md-6 col-lg-6">
							<div class="input-group start-year">
							  <span class="input-group-addon">START YEAR</span>
							  <input type="text" class="form-control startYear" placeholder="earliest year" value="1980">
							</div> <!-- /.input-group -->
						</div> <!-- /.col-xs-6 col-sm-6 -->

						<div class="col-xs-12 col-sm-6 col-md-6 col-lg-6">
							<div class="input-group end-year">
							  <span class="input-group-addon">END YEAR</span>
							  <input type="text" class="form-control endYear" placeholder="latest year" value="2000">
								<span class="input-group-btn">
									<button class="btn btn-default go" type="button">GO</button>
								</span> <!-- /.input-group-btn -->
							</div> <!-- /.input-group -->
						</div> <!-- /.col-xs-6 col-sm-6 -->
					</div> <!-- /.row -->


					<div class="row input-events">
						<div class="col-xs-12 col-sm-4 col-md-6 col-lg-6">
							<div class="input-group event-name">
								<span class="input-group-addon">NAME</span>
								<input type="text" class="form-control event-name-input" value="ANDROMEDA ASCENDANT">
							</div> <!-- /input-group -->
						</div> <!-- /.col-lg-6 -->

						<div class="col-xs-12 col-sm-4 col-md-2 col-lg-2">
							<div class="input-group event-start">
								<span class="input-group-addon">START</span>
								<input type="text" class="form-control event-start-input" value="1984">
							</div> <!-- /input-group -->
						</div> <!-- /.col-lg-6 -->

						<div class="col-xs-12 col-sm-4 col-md-4 col-lg-4">
							<div class="input-group event-end">
								<span class="input-group-addon">END&nbsp;&nbsp;</span>
								<input type="text" class="form-control event-end-input" value="1989">
								  <div class="input-group-btn">
									<button class="btn btn-default add" type="button">ADD EVENT</button>
									<!-- <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown"><span class="caret"></span></button>
									<ul class="dropdown-menu dropdown-menu-right" role="menu">
									  <li class='add-same-line'><a href="#">Add event on Same Line</a></li>
									</ul> -->
								  </div><!-- /btn-group -->
							</div> <!-- /input-group -->
						</div> <!-- /.col-lg-6 -->				
					</div> <!-- /.row -->

				</div> <!-- /.form-group -->
				<p class="notification-text bg-danger text-danger">still the same og</p>
				<div class="canvas-container">
					<canvas id="myCanvas" class="myCanvasClass" width="100%" height="100%" resize="true"></canvas>
				</div>
				<script type="text/paperscript" canvas="myCanvas">
				
// ================== 
// Instructions
// ================== 
var splashText = new PointText({
	point: view.center,
	justification: 'center',
	fontSize: 20,
	// fontFamily: 'Lato',
	// fontWeight: '500',
	blendMode: 'xor',
	content: "\nHello, and welcome to the\nTimeline Creation Tool!\nTake a look at the input\nfields above this area.\n\nInput a START YEAR\nand an END YEAR.\n",
	fillColor: {
		hue: Math.random() * 360,
		saturation: 0.5,
		brightness: 1
	},
	onMouseMove: function() {
		splashText.fillColor.hue += 1;
	}
});

// ================== 
// LAYER 01
// ================== 
var splashLayer = new Layer([splashText]);
	splashText.fitBounds(view.bounds)
	paper.view.draw()
	splashLayer.activate();



// ================== 
// Variables
// ================== 
var clickNum = 0;
var clickOne = 0;
// ==============
var width = view.size.width;
var height = view.size.height;
var center = view.center;
var top = view.bounds.top;
var left = view.bounds.left;
var right = view.bounds.right;
var bottom = view.bounds.bottom;

// // ======================================================================



// ================== 
// Constructors
// ================== 
function InputDate(startYearStringVar, endYearStringVar) {
	this.startYearString = startYearStringVar;
	this.endYearString = endYearStringVar;
	this.startYear = parseInt(startYearStringVar);
	this.endYear = parseInt(endYearStringVar);
	this.dateRange = this.endYear - this.startYear;
}

function InputEvent(eventNameVar, eventStartStringVar, eventEndStringVar) {
	this.eventName = eventNameVar;
	this.eventStartString = eventStartStringVar;
	this.eventEndString = eventEndStringVar;
	this.eventStart = parseInt(eventStartStringVar);
	this.eventEnd = parseInt(eventEndStringVar);
	this.eventRange = this.eventEnd - this.eventStart;
}



// ================== 
// Global Paper Basics
// ================== 
var path = new Path({
	strokeColor: '#d9534f',
	strokeWidth: 3
});

var guidePathTop = new Path({
	strokeColor: '#d9534f',
	strokeWidth: 3
});

var guidePathBottom = new Path({
	strokeColor: '#d9534f',
	strokeWidth: 3
});

var style = {
	strokeColor: [0.3],
	strokeWidth: 2,
	fontSize: 20
};


// ================== 
// Functions
// ================== 
function checkInputDate() {
	var startYearString = inputDate.startYearString;
	var endYearString = inputDate.endYearString;
	var startYear = inputDate.startYear;
	var endYear = inputDate.endYear;


	switch (true) {
		case (startYear >= endYear):
			reportError({
				message: 'START YEAR should come before END YEAR.',
				add: $('.start-year'),
				remove: $('.end-year')
			});
			break;
		case (startYearString.trim() === ""):
			reportError({
				message: 'Need START YEAR.',
				add: $('.start-year'),
				remove: $('.end-year')
			});
			break;
		case (endYearString.trim() === ""):
			reportError({
				message: 'Need END YEAR.',
				add: $('.end-year'),
				remove: $('.start-year')
			});
			break;
		case (startYear < 1000):
			reportError({
				message: 'Year needs to match YYYY',
				add: $('.start-year'),
				remove: $('.end-year')
			});
			break;
		case (endYear < 1000):
			reportError({
				message: 'Year needs to match YYYY',
				add: $('.end-year'),
				remove: $('.start-year')
			});
			break;
		default:
			$('.input-dates, .input-events').addClass('activated');
			splashLayer.visible = false;
			console.log('default switch fired, you did real good there grasshopper');
			clearError()
			paper.view.draw()
			renderGuide()
	} // end switch
} // end function checkInputDate(){}

function checkInputEvent() {
	var eventStartString = inputEvent.eventStartString;
	var eventEndString = inputEvent.eventEndString;
	var eventStart = inputEvent.eventStart;
	var eventName = inputEvent.eventName;
	var eventEnd = inputEvent.eventEnd;
	var endYear = inputDate.endYear;

	switch (true) {
		case (eventName.trim() === ""):
			$(this).data('clickNum', clickNum -= 20);
			reportError({
				message: 'Please enter a name of your new Event.',
				add: $('.event-name'),
				remove: $('.event-start, .event-end')
			});
			break;
		case (eventEnd < 1000):
			$(this).data('clickNum', clickNum -= 20);
			reportError({
				message: 'END needs to match YYYY.',
				add: $('.event-end'),
				remove: $('.event-start, .event-name')
			});
			break;
		case (eventStartString.trim() === ""):
			$(this).data('clickNum', clickNum -= 20);
			reportError({
				message: 'Need event START year.',
				add: $('.event-start'),
				remove: $('.event-end, .event-name')
			});
			break;
		case (eventEndString.trim() === ""):
			$(this).data('clickNum', clickNum -= 20);
			reportError({
				message: 'Need event END year.',
				add: $('.event-end'),
				remove: $('.event-start, .event-name')
			});
			break;
		case (eventEnd > endYear):
			$(this).data('clickNum', clickNum -= 20);
			reportError({
				message: 'END should be before the graph\'s end year.',
				add: $('.event-end'),
				remove: $('.event-start, .event-name')
			});
			break;
		case (eventStart < 1000):
			$(this).data('clickNum', clickNum -= 20);
			reportError({
				message: 'START needs to match YYYY.',
				add: $('.event-start'),
				remove: $('.event-end, .event-name')
			});
			break;
		case (eventStart < inputDate.startYear):
			$(this).data('clickNum', clickNum -= 20);
			reportError({
				message: 'START should be after the graph\'s start year.',
				add: $('.event-start'),
				remove: $('.event-end, .event-name')
			});
			break;
		case (eventStart > eventEnd):
			$(this).data('clickNum', clickNum -= 20);
			reportError({
				message: 'START needs be before END',
				add: $('.event-start'),
				remove: $('.event-end, .event-name')
			});
			break;
		default:
			clearError();
			renderData()
	} // end switch
} // end function checkInputEvent(){

function reportError(error) {
	$('.notification-text').html(error.message).addClass('activated');
	error.add.addClass('has-error');
	error.remove.removeClass('has-error');
}

function clearError() {
	$('.notification-text').html('').removeClass('activated');
	$('.has-error').removeClass('has-error');
}

// /////////////////
// /////////////////
// /////////////////

function clickNums() {
	if (!clickNum) clickNum = +52;
	$(this).data('clickNum', clickNum += 20);
} // end function clickNums(){}
function clicksOne() {
	if (!clickOne) clickOne = 0;
	$(this).data('clickOne', clickOne += 1);

	if (clickOne === ((clickOne + 1) / 2) > (height - 104) / 20) {
		$('.notification-text').html(clickOne + ' is the total number of points that this graph can display.');
		$('.add').prop( "disabled", true);
		// $('.notification-text').html('START YEAR should come before END YEAR.');
		$('.notification-text').addClass('activated');
	}

} // function clicksOne(){}

// /////////////////
// /////////////////
// /////////////////

function renderGuide() {
	var dateRange = inputDate.dateRange;

	guidePathTop.add([left, (top + 50)]);
	for (var i = 1; i < dateRange; i++) {
		var point = new Point(width / dateRange * i, (top + 50));
		guidePathTop.add(point);
		} // end for (){}
	guidePathTop.add([right, (top + 50)]);

	guidePathBottom.add([left, (bottom - 50)]);
	for (var i = 1; i < dateRange; i++) {
		var point = new Point(width / dateRange * i, (bottom - 50));
		guidePathBottom.add(point);
		} // end for (){}
	guidePathBottom.add([right, (bottom - 50)]);


	guidePathLayer = new Layer([guidePathBottom, guidePathTop])
	paper.view.draw();
	renderGuideText();
} // end function initializePath() {}

function renderGuideText(){
	var startYear = inputDate.startYear;
	var dateRange = inputDate.dateRange;

	var counter = startYear;
	for (var i = 1; i < dateRange; i++) {
		var guideText = new PointText({
			point: [width / dateRange * i, (top + 8)],
			content: (counter += 1),
			fillColor: 'white'
		})
		guideText.rotate(300);
	 guideText.position.x -= 14;
	 guideText.position.y += 25;
	} // end for (){}

	var counter = startYear;
	for (var i = 1; i < dateRange; i++) {
		var guideText = new PointText({
			point: [width / dateRange * i, (bottom - 50)],
			content: (counter += 1),
			fillColor: 'white'
		})
		guideText.rotate(300);
	 guideText.position.x -= 14;
	 guideText.position.y += 25;
	} // end for (){}

	guideTextLayer = new Layer([guideText])
	paper.view.draw();
	renderReferencePaths()
	// initializeReferencePaths();
}

function renderReferencePaths(){
	var dateRange = inputDate.dateRange;
	
	for (var i = 1; i < dateRange; i++) {
		var from = new Point(width / dateRange * i, top + 52);
		var to = new Point(width / dateRange * i, bottom - 52);
		var referencePath = new Path.Line(from, to);
		referencePath.style = style;
		referencePath.strokeColor = 'black'
	} // end for (){}
	referencePathsLayer = new Layer(referencePath);
	paper.view.draw();
}

// /////////////////
// /////////////////
// /////////////////
function renderEventName(){
	var eventName = inputEvent.eventName;

	var eventNameText = new PointText(5, (bottom - clickNum) + 1);
		eventNameText.content = eventName;
		eventNameText.fillColor = 'white';
		eventNameText.position.y += 14;

	eventNameLayerBG = new Layer()
	var eventNameReferenceBG = new Rectangle(
		new Point(0, (bottom - clickNum)),
		new Size(eventNameText.bounds.width + 7, 20)
	);
	var pathBG = new Path.Rectangle(eventNameReferenceBG);
		pathBG.fillColor = '#333333';
			// var blends = ['normal', 'multiply', 'screen', 'overlay', 'soft-light', 'hard-light', 'color-dodge', 'color-burn', 'darken', 
			// 				'lighten', 'difference', 'exclusion', 'hue', 'saturation', 'luminosity', 'color', 'add', 'subtract', 'average', 
			//				'pin-light', 'negation', 'source-over', 'source-in', 'source-out', 'source-atop', 'destination-over', 'destination-in', 
			// 				'destination-out', 'destination-atop', 'lighter', 'darker', 'copy', 'xor']
		pathBG.blendMode = 'hard-light'
	eventNameLayerBG.activate()

	var eventReferencePath = new Path();
		eventReferencePath.add(new Point(eventNameText.bounds.width, bottom - clickNum) + 10);
		eventReferencePath.add(new Point(right, bottom - clickNum) + 10);
		eventReferencePath.fillColor = "white";
		eventReferencePath.strokeColor = [0.5];
		eventReferencePath.strokeWidth = 1;
		eventReferencePath.dashArray = [5, 5];
		eventReferencePath.blendMode = 'hard-light'

	eventNameLayer = new Layer(eventNameText)
	paper.view.draw()
}

function renderData(){
	var eventRange = inputEvent.eventRange;
	var eventStart = inputEvent.eventStart;
	var dateRange = inputDate.dateRange;
	var startYear = inputDate.startYear;

	if (eventRange < 1) {
		var eventRect = new Path.Circle({
			center: [(width / dateRange) * (eventStart - startYear), ((bottom - clickNum) + 7)],
			radius: 10
			})
			eventRect.fillColor = {
				hue: Math.random() * 360,
				saturation: 0.5,
				brightness: 1
			}
		paper.view.draw()
	} else {
		var eventRect = new Rectangle(
			new Point((width / dateRange) * (eventStart - startYear), (bottom - clickNum)),
			new Size(((width / dateRange) * eventRange), 20)
		);
		var eventRectPath = new Path.Rectangle(eventRect);
			eventRectPath.fillColor = {
				hue: Math.random() * 360,
				saturation: 1,
				brightness: 1
			};
		eventRectLayer = new Layer(eventRectPath)
		paper.view.draw()
		renderEventName();
	}
}




// ================== 
// Buttons
// ================== 
$('.go').click(function() {
	var startYearString = $('.startYear').val();
	var endYearString = $('.endYear').val();
	inputDate = new InputDate(startYearString, endYearString);
	// console.log(inputDate)
	checkInputDate()
})

$('.add').click(function() {
	var eventName = $('.event-name-input').val();
	var eventStartString = $('.event-start-input').val();
	var eventEndString = $('.event-end-input').val();

	inputEvent = new InputEvent(eventName, eventStartString, eventEndString)
	checkInputEvent()

	clickNums()
	clicksOne()
	console.log("clickOne:", clickOne, ", clickNum:", clickNum);
	if (clickOne === (view.size.height - 84) / 20){
		$('.notification-text').html(clickOne + ' is the total number of points that this graph can display.');
		$('.add').prop( "disabled", true);
		$('.notification-text').addClass('activated');
	}
})

$('.scifi').click(function(){
	project.clear();
	paper.view.draw();

	var startYearString = $('.startYear').val('1986');
	var endYearString = $('.endYear').val('2014');
	
	// var eventName = inputEvent.eventName;

	$('.go').click();
	// inputDate = new InputDate(startYearString, endYearString);

	for (i = 0; i < scifi.results.length; i++){
		// inputEvent = new InputEvent(eventName, eventStartString, eventEndString)
		var eventName = $('.event-name-input').val(scifi.results[i].name);
		console.log(scifi.results[i].name)
		var eventStartString = $('.event-start-input').val(scifi.results[i].start);
		var eventEndString = $('.event-end-input').val(scifi.results[i].end);
		$('.add').click();
	}
	paper.view.draw();
})

				</script>

			</div> <!-- /.jumbotron -->

			<!-- <button class="save btn">Save as PNG</button> -->
		</div>

<!-- /main area -->

		<div class="footer"></div>

		<!-- build:js(.) scripts/vendor.js -->
		<!-- bower:js -->
		<script src="bower_components/jquery/dist/jquery.js"></script>
		<script src="bower_components/paper/dist/paper-full.js"></script>
		<script src="bower_components/underscore/underscore.js"></script>
		<script src="bower_components/blob/blob.js"></script>
		<script src="bower_components/FileSaver/FileSaver.js"></script>
		<script src="bower_components/jquery-mousewheel/jquery.mousewheel.js"></script>
		<script src="bower_components/moment/moment.js"></script>
		<!-- endbower -->
		<!-- endbuild -->
		<script src="//www.parsecdn.com/js/parse-1.2.18.min.js"></script>


		<!-- Google Analytics: change UA-XXXXX-X to be your site's ID. -->
		<script>
		(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=
		function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;
		e=o.createElement(i);r=o.getElementsByTagName(i)[0];
		e.src='//www.google-analytics.com/analytics.js';
		r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));
		ga('create','UA-XXXXX-X');ga('send','pageview');
		</script>
		<!-- build:js(.) scripts/plugins.js -->
		<script src="bower_components/bootstrap-sass-official/vendor/assets/javascripts/bootstrap/affix.js"></script>
		<script src="bower_components/bootstrap-sass-official/vendor/assets/javascripts/bootstrap/alert.js"></script>
		<script src="bower_components/bootstrap-sass-official/vendor/assets/javascripts/bootstrap/dropdown.js"></script>
		<script src="bower_components/bootstrap-sass-official/vendor/assets/javascripts/bootstrap/tooltip.js"></script>
		<script src="bower_components/bootstrap-sass-official/vendor/assets/javascripts/bootstrap/modal.js"></script>
		<script src="bower_components/bootstrap-sass-official/vendor/assets/javascripts/bootstrap/transition.js"></script>
		<script src="bower_components/bootstrap-sass-official/vendor/assets/javascripts/bootstrap/button.js"></script>
		<script src="bower_components/bootstrap-sass-official/vendor/assets/javascripts/bootstrap/popover.js"></script>
		<script src="bower_components/bootstrap-sass-official/vendor/assets/javascripts/bootstrap/carousel.js"></script>
		<script src="bower_components/bootstrap-sass-official/vendor/assets/javascripts/bootstrap/scrollspy.js"></script>
		<script src="bower_components/bootstrap-sass-official/vendor/assets/javascripts/bootstrap/collapse.js"></script>
		<script src="bower_components/bootstrap-sass-official/vendor/assets/javascripts/bootstrap/tab.js"></script>
		<!-- endbuild -->
		

		<!-- build:js({app,.tmp}) scripts/main.js -->
		<script src="scripts/canvas-toBlob.js"></script>
		<script src="scripts/data.js"></script>
		<script src="scripts/parse-data.js"></script>
		<script src="scripts/router.js"></script>
		<script src="scripts/main.js"></script>
		<!-- endbuild -->
		
		


	</body>
</html>